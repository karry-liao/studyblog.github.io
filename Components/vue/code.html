<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一、数据驱动 | 芒梨博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/studyblog.github.io/favicon.ico">
    <meta name="description" content="个人博客">
    
    <link rel="preload" href="/studyblog.github.io/assets/css/0.styles.909ac081.css" as="style"><link rel="preload" href="/studyblog.github.io/assets/js/app.f0e12a78.js" as="script"><link rel="preload" href="/studyblog.github.io/assets/js/40.d9be3eca.js" as="script"><link rel="preload" href="/studyblog.github.io/assets/js/108.7ad6bf33.js" as="script"><link rel="prefetch" href="/studyblog.github.io/assets/js/1.b02d74d2.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/10.b17b1454.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/100.9ccb8ff5.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/101.9a6065c9.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/102.d9b0dc75.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/103.b59a959f.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/104.3c41d096.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/105.39d6a1bf.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/106.de530c1f.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/107.b911e829.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/109.74425d8f.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/11.fc60087f.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/110.3098ee2d.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/111.0bf05e2b.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/112.5062fc88.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/113.9466436f.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/114.1a39ff02.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/115.26d62c9c.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/116.b16806ce.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/117.3426e142.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/118.8dbabedb.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/119.cc748d1d.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/12.a8424531.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/120.06d704a0.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/121.9507695f.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/122.f8191ff1.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/13.8881e980.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/14.86498cbd.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/15.ff515cbc.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/16.312f25fa.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/17.ea47a715.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/18.4ac56ec1.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/19.25072e28.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/2.c4005836.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/20.6ffca9bc.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/21.1446824b.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/22.2427ee9c.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/23.71623e8f.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/24.ca6937ce.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/25.3cf22008.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/26.e9f5d451.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/27.997f2ec1.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/28.382de87b.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/29.c4a93538.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/3.85361af2.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/30.3186d405.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/31.d31716d8.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/32.13b38d37.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/33.8230cc92.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/34.bcfb09e0.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/35.bd476159.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/36.2ac586fb.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/37.33fe0a40.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/38.15297a4b.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/4.68d54ffc.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/41.ee0d6da9.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/42.98037d28.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/43.5eb93b80.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/44.ebfddeec.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/45.07f22e5d.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/46.ca6509d7.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/47.167cc8c7.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/48.e49b0bc6.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/49.359dcda5.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/5.f9275404.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/50.40bc046b.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/51.09112a23.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/52.5b9f0a6c.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/53.10084720.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/54.414f0929.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/55.1bce53a8.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/56.8fc2e531.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/57.75ab8c94.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/58.59738ca1.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/59.abf7cbaa.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/6.1a0c9509.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/60.3ef9fcf3.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/61.f5a3b2eb.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/62.83dcf1ab.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/63.9f6d4271.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/64.84fcc949.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/65.9442cadb.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/66.8fa85f24.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/67.a1526bfb.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/68.036f590a.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/69.b93c3d06.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/7.a37045f7.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/70.a6651988.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/71.c79e8f63.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/72.3a0a349f.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/73.a434f014.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/74.de69bf46.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/75.5b93594a.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/76.86bec0df.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/77.e9eadbc7.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/78.c19452de.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/79.9bdfc593.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/8.e8a007a5.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/80.e41b535e.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/81.738256da.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/82.2f67a9f7.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/83.f05575bc.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/84.594d6562.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/85.89a0f5f1.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/86.dd808c0c.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/87.26c2dbf8.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/88.0f265bcc.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/89.8b453b75.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/9.094050ec.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/90.d840a8c6.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/91.ea9fe229.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/92.099100b7.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/93.d4c09ee5.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/94.2fa1d1a6.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/95.97dd1ef0.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/96.a583d717.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/97.ed8eba3f.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/98.c446bc32.js"><link rel="prefetch" href="/studyblog.github.io/assets/js/99.487f378e.js">
    <link rel="stylesheet" href="/studyblog.github.io/assets/css/0.styles.909ac081.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/studyblog.github.io/" class="home-link router-link-active"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fc-ssl.duitang.com%2Fuploads%2Fitem%2F201911%2F30%2F20191130103938_uNhF5.thumb.700_0.jpeg&amp;refer=http%3A%2F%2Fc-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664606884&amp;t=978883c3b180812cc76c793f1f6a6b92" alt="芒梨博客" class="logo"> <span class="site-name can-hide">芒梨博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/studyblog.github.io/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/studyblog.github.io/Components/Echarts/echarts.html" class="nav-link">
  数据可视化
</a></div><div class="nav-item"><a href="/studyblog.github.io/Components/javascript/base.html" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/studyblog.github.io/Components/vue/base.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/studyblog.github.io/Components/CpNet/base.html" class="nav-link">
  计算机网络知识
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试总结" class="dropdown-title"><span class="title">面试总结</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试总结" class="mobile-dropdown-title"><span class="title">面试总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/studyblog.github.io/Components/md_interview/interview.html" class="nav-link">
  常见总结
</a></li><li class="dropdown-item"><!----> <a href="/studyblog.github.io/Components/md_interview/Vue.html" class="nav-link">
  Vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ThreeJS" class="dropdown-title"><span class="title">ThreeJS</span> <span class="arrow down"></span></button> <button type="button" aria-label="ThreeJS" class="mobile-dropdown-title"><span class="title">ThreeJS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/studyblog.github.io/Components/ThreeJS/Lamborghini.html" class="nav-link">
  中文
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/karry-liao?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/studyblog.github.io/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/studyblog.github.io/Components/Echarts/echarts.html" class="nav-link">
  数据可视化
</a></div><div class="nav-item"><a href="/studyblog.github.io/Components/javascript/base.html" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/studyblog.github.io/Components/vue/base.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/studyblog.github.io/Components/CpNet/base.html" class="nav-link">
  计算机网络知识
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试总结" class="dropdown-title"><span class="title">面试总结</span> <span class="arrow down"></span></button> <button type="button" aria-label="面试总结" class="mobile-dropdown-title"><span class="title">面试总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/studyblog.github.io/Components/md_interview/interview.html" class="nav-link">
  常见总结
</a></li><li class="dropdown-item"><!----> <a href="/studyblog.github.io/Components/md_interview/Vue.html" class="nav-link">
  Vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ThreeJS" class="dropdown-title"><span class="title">ThreeJS</span> <span class="arrow down"></span></button> <button type="button" aria-label="ThreeJS" class="mobile-dropdown-title"><span class="title">ThreeJS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/studyblog.github.io/Components/ThreeJS/Lamborghini.html" class="nav-link">
  中文
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/karry-liao?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开发指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/studyblog.github.io/Components/base/introduce.html" class="sidebar-link">介绍</a></li><li><a href="/studyblog.github.io/Components/base/Reg.html" class="sidebar-link">正则表达式</a></li><li><a href="/studyblog.github.io/Components/base/Reg.html" class="sidebar-link">Map和Set的区别</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML&amp;CSS篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/studyblog.github.io/Components/htmlcss/HtmlsCSS.html" class="sidebar-link">HTML&amp;CSS</a></li><li><a href="/studyblog.github.io/Components/htmlcss/AutoResize.html" class="sidebar-link">响应式布局方案</a></li><li><a href="/studyblog.github.io/Components/htmlcss/CSS.html" class="sidebar-link">CSS样式</a></li><li><a href="/studyblog.github.io/Components/htmlcss/Selector.html" class="sidebar-link">CSS选择器</a></li><li><a href="/studyblog.github.io/Components/htmlcss/Flex.html" class="sidebar-link">Flex布局</a></li><li><a href="/studyblog.github.io/Components/htmlcss/animation.html" class="sidebar-link">前端动画</a></li><li><a href="/studyblog.github.io/Components/htmlcss/FontCss.html" class="sidebar-link">花式字体</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue组件篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/studyblog.github.io/Components/static/IconStyle.html" class="sidebar-link">IconStyle</a></li><li><a href="/studyblog.github.io/Components/static/GuaguaLe.html" class="sidebar-link">canvas之刮刮乐</a></li><li><a href="/studyblog.github.io/Components/static/LuckyRolling.html" class="sidebar-link">幸运大转盘</a></li><li><a href="/studyblog.github.io/Components/static/Pinterest.html" class="sidebar-link">瀑布流</a></li><li><a href="/studyblog.github.io/Components/static/Icon.html" class="sidebar-link">图标</a></li><li><a href="/studyblog.github.io/Components/static/Button.html" class="sidebar-link">光亮按钮</a></li><li><a href="/studyblog.github.io/Components/static/Message.html" class="sidebar-link">信息提醒框</a></li><li><a href="/studyblog.github.io/Components/static/MagnifyingGlass.html" class="sidebar-link">放大镜效果</a></li><li><a href="/studyblog.github.io/Components/static/SlideVerify.html" class="sidebar-link">滑块验证</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue篇</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/studyblog.github.io/Components/vue/base.html" class="sidebar-link">Vue基础</a></li><li><a href="/studyblog.github.io/Components/vue/permissionControl.html" class="sidebar-link">前端权限控制</a></li><li><a href="/studyblog.github.io/Components/vue/directive.html" class="sidebar-link">Vue自定义指令</a></li><li><a href="/studyblog.github.io/Components/vue/template.html" class="sidebar-link">Ajax失败重连&amp;Fn柯里化&amp;Render</a></li><li><a href="/studyblog.github.io/Components/vue/vuex.html" class="sidebar-link">Vuex状态管理</a></li><li><a href="/studyblog.github.io/Components/vue/FirstLoad.html" class="sidebar-link">首屏加载优化</a></li><li><a href="/studyblog.github.io/Components/vue/mixin.html" class="sidebar-link">VueMixin混入</a></li><li><a href="/studyblog.github.io/Components/vue/innerComponents.html" class="sidebar-link">Vue内置组件</a></li><li><a href="/studyblog.github.io/Components/vue/Vuethree.html" class="sidebar-link">Vue3.0</a></li><li><a href="/studyblog.github.io/Components/vue/Axios.html" class="sidebar-link">Axios</a></li><li><a href="/studyblog.github.io/Components/vue/code.html" aria-current="page" class="active sidebar-link">Vue源码分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#一、数据驱动" class="sidebar-link">一、数据驱动</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#二、vue初始化" class="sidebar-link">二、vue初始化</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#三、mount-挂载" class="sidebar-link">三、mount 挂载</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#四、组件化" class="sidebar-link">四、组件化</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#五、如何让数据变得可观测" class="sidebar-link">五、如何让数据变得可观测？</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#六、diff算法" class="sidebar-link">六、Diff算法</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#七、vue模板是如何编译的" class="sidebar-link">七、Vue模板是如何编译的</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#八、模板编译" class="sidebar-link">八、模板编译</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#九、vue中style标签中的scoped是如何工作的" class="sidebar-link">九、Vue中style标签中的scoped是如何工作的</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十、vue3怎么设置全局变量" class="sidebar-link">十、Vue3怎么设置全局变量</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十一、刷新浏览器后-vuex的数据是否存在-如何解决" class="sidebar-link">十一、刷新浏览器后，Vuex的数据是否存在？如何解决？</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#使用-localstorage-或者-sessionstroage" class="sidebar-link">使用 localStorage 或者 sessionStroage</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十二、vite" class="sidebar-link">十二、Vite</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十三、vue中-route和-router有什么区别" class="sidebar-link">十三、Vue中$route和$router有什么区别</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十四、vue3响应式的使用" class="sidebar-link">十四、Vue3响应式的使用</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十五、history和hash模式的区别" class="sidebar-link">十五、history和hash模式的区别</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十六、vnode有哪些属性" class="sidebar-link">十六、VNode有哪些属性</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十七、vue2-0为什么不能检查数组的变化" class="sidebar-link">十七、Vue2.0为什么不能检查数组的变化</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十八、vue页面渲染流程" class="sidebar-link">十八、Vue页面渲染流程</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#十九、react与vue区别" class="sidebar-link">十九、React与Vue区别</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#二十、computed和watch的区别" class="sidebar-link">二十、computed和watch的区别</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#二十一、vue-loader" class="sidebar-link">二十一、Vue-Loader</a></li><li class="sidebar-sub-header"><a href="/studyblog.github.io/Components/vue/code.html#二十二、自定义指令" class="sidebar-link">二十二、自定义指令</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>WebPack篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>业务功能篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NodeJS篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Web性能提升篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MiniPrograme篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络知识篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构与算法篇</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="一、数据驱动"><a href="#一、数据驱动" class="header-anchor">#</a> 一、数据驱动</h2> <p><strong>VUE</strong>:本质上就是一个用 Function 实现的 Class，然后它的原型 prototype 以及它本身都扩展了一系列的方法和属性.</p> <p><strong>Vue.js</strong> 一个<u>核心思想</u>是<strong>数据驱动</strong>。所谓数据驱动，是指视图是由数据驱动生成的，我们对视图的修改，不会直接操作 DOM，而是通过修改数据。相比我们传统的前端开发，如使用 jQuery 等前端库直接修改 DOM，大大简化了代码量。特别是当交互复杂的时候，只关心数据的修改会让代码的逻辑变的非常清晰，因为 DOM 变成了数据的映射，我们所有的逻辑都是对数据的修改，而不用碰触 DOM，这样的代码非常利于维护。</p> <h2 id="二、vue初始化"><a href="#二、vue初始化" class="header-anchor">#</a> 二、vue初始化</h2> <h3 id=""><a href="#" class="header-anchor">#</a></h3> <p><strong><code>Vue</code></strong> 只能通过 new 关键字初始化，然后会调用 <code>this._init</code> 方法， 该方法在 <code>src/core/instance/init.js</code> 中定义。</p> <h3 id="-2"><a href="#-2" class="header-anchor">#</a></h3> <p>Vue 初始化主要就干了几件事情，合并配置，初始化生命周期，初始化事件中心，初始化渲染，初始化 data、props、computed、watcher 等等。</p> <h2 id="三、mount-挂载"><a href="#三、mount-挂载" class="header-anchor">#</a> 三、mount 挂载</h2> <p>​		通过$mount实例方法去挂载vm，<code>$mount</code> 方法支持传入 2 个参数，第一个是 <code>el</code>，它表示挂载的元素，可以是字符串，也可以是 DOM 对象，如果是字符串在浏览器环境下会调用 <code>query</code> 方法转换成 DOM 对象的。第二个参数是和服务端渲染相关，在浏览器环境下我们不需要传第二个参数。<code>$mount</code> 方法实际上会去调用 <code>mountComponent</code> 方法，mountComponent 核心就是先实例化一个渲染<code>Watcher</code>，在它的回调函数中会调用 <code>updateComponent</code> 方法，在此方法中调用 <code>vm._render</code> 方法先生成虚拟 Node，最终调用 <code>vm._update</code> 更新 DOM。</p> <img src="https://i.bmp.ovh/imgs/2022/04/24/2a1534b5e777c3a7.png" width="100%"> <h2 id="四、组件化"><a href="#四、组件化" class="header-anchor">#</a> 四、组件化</h2> <p>​		构造子类构造函数，安装组件钩子函数和实例化 <code>vnode</code>。</p> <p>​		<code>createComponent</code> 的实现，了解到它在渲染一个组件的时候的 3 个关键逻辑：<strong>构造子类构造函数，安装组件钩子函数和实例化 <code>vnode</code></strong>。<code>createComponent</code> 后返回的是组件 <code>vnode</code>，它也一样走到 <code>vm._update</code> 方法，进而执行了 <code>patch</code> 函数，执行 <code>vm.__patch__</code> 去把 VNode 转换成真正的 DOM 节点</p> <h2 id="五、如何让数据变得可观测"><a href="#五、如何让数据变得可观测" class="header-anchor">#</a> 五、如何让数据变得可观测？</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token number">20</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
	<span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'age属性被读取了'</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> value
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">set</span><span class="token punctuation">(</span>newvalue<span class="token punctuation">)</span><span class="token punctuation">{</span>
	val <span class="token operator">=</span> newvalue
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'age属性被修改了'</span><span class="token punctuation">,</span>newvalue<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>//_Observe类</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Module<span class="token punctuation">.</span>export <span class="token keyword">class</span> <span class="token class-name">Observe</span><span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value
	<span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">walk</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">const</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>Obj<span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">definReactive</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span>key<span class="token punctuation">,</span>val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">===</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        val <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">Observe</span>
    <span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
	<span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">属性被读取了</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> value
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">set</span><span class="token punctuation">(</span>newvalue<span class="token punctuation">)</span><span class="token punctuation">{</span>
	val <span class="token operator">=</span> newvalue
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>newvalue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">属性被修改了</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>newvalue<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="六、diff算法"><a href="#六、diff算法" class="header-anchor">#</a> 六、Diff算法</h2> <p>​		<code>diff</code> 算法是一种通过同层的树节点进行比较的高效算法</p> <p>其有两个特点：</p> <ul><li>比较只会在同层级进行, 不会跨层级比较</li> <li>在diff比较的过程中，循环从两边向中间比较</li></ul> <p>当数据发生改变时，<code>set</code>方法会调用<code>Dep.notify</code>通知所有订阅者<code>Watcher</code>，订阅者就会调用<code>patch</code>给真实的<code>DOM</code>打补丁，更新相应的视图</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> hydrating<span class="token punctuation">,</span> removeOnly</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndef</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 没有新节点，直接执行destory钩子函数</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDef</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">invokeDestroyHook</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> isInitialPatch <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">const</span> insertedVnodeQueue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndef</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        isInitialPatch <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token function">createElm</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> insertedVnodeQueue<span class="token punctuation">)</span> <span class="token comment">// 没有旧节点，直接用新节点生成dom元素</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> isRealElement <span class="token operator">=</span> <span class="token function">isDef</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>nodeType<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isRealElement <span class="token operator">&amp;&amp;</span> <span class="token function">sameVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 判断旧节点和新节点自身一样，一致执行patchVnode</span>
            <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> insertedVnodeQueue<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> removeOnly<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 否则直接销毁及旧节点，根据新节点生成dom元素</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isRealElement<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> oldVnode<span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token constant">SSR_ATTR</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    oldVnode<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token constant">SSR_ATTR</span><span class="token punctuation">)</span>
                    hydrating <span class="token operator">=</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isTrue</span><span class="token punctuation">(</span>hydrating<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hydrate</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> insertedVnodeQueue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">invokeInsertHook</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> insertedVnodeQueue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> oldVnode
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                oldVnode <span class="token operator">=</span> <span class="token function">emptyNodeAt</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> vnode<span class="token punctuation">.</span>elm
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>patch</code>函数前两个参数位为<code>oldVnode</code> 和 <code>Vnode</code> ，分别代表新的节点和之前的旧节点，主要做了四个判断：</p> <ul><li><p>没有新节点，直接触发旧节点的<code>destory</code>钩子</p></li> <li><p>没有旧节点，说明是页面刚开始初始化的时候，此时，根本不需要比较了，直接全是新建，所以只调用 <code>createElm</code></p></li> <li><p>旧节点和新节点自身一样，通过 <code>sameVnode</code> 判断节点是否一样，一样时，直接调用 <code>patchVnode</code>去处理这两个节点</p></li> <li><p>旧节点和新节点自身不一样，当两个节点不一样的时候，直接创建新节点，删除旧节点</p></li> <li><p>当数据发生改变时，订阅者<code>watcher</code>就会调用<code>patch</code>给真实的<code>DOM</code>打补丁</p></li> <li><p>通过<code>isSameVnode</code>进行判断，相同则调用<code>patchVnode</code>方法</p></li> <li><div class="language- extra-class"><pre class="language-text"><code>patchVnode
</code></pre></div><p>做了以下操作：</p> <ul><li>找到对应的真实<code>dom</code>，称为<code>el</code></li> <li>如果都有都有文本节点且不相等，将<code>el</code>文本节点设置为<code>Vnode</code>的文本节点</li> <li>如果<code>oldVnode</code>有子节点而<code>VNode</code>没有，则删除<code>el</code>子节点</li> <li>如果<code>oldVnode</code>没有子节点而<code>VNode</code>有，则将<code>VNode</code>的子节点真实化后添加到<code>el</code></li> <li>如果两者都有子节点，则执行<code>updateChildren</code>函数比较子节点</li></ul></li> <li><div class="language- extra-class"><pre class="language-text"><code>updateChildren
</code></pre></div><p>主要做了以下操作：</p> <ul><li>设置新旧<code>VNode</code>的头尾指针</li> <li>新旧头尾指针进行比较，循环向中间靠拢，根据情况调用<code>patchVnode</code>进行<code>patch</code>重复流程、调用<code>createElem</code>创建一个新节点，从哈希表寻找 <code>key</code>一致的<code>VNode</code> 节点再分情况操作</li></ul></li></ul> <h2 id="七、vue模板是如何编译的"><a href="#七、vue模板是如何编译的" class="header-anchor">#</a> 七、Vue模板是如何编译的</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>render 函数是怎么来的有两种方式</p> <ul><li>第一种就是经过模板编译生成 render 函数</li> <li>第二种是我们自己在组件里定义了 render 函数，这种会跳过模板编译的过程</li></ul> <h2 id="八、模板编译"><a href="#八、模板编译" class="header-anchor">#</a> 八、模板编译 </h2> <p>​		这个是模板，不是真实的 HTML，浏览器是不认识模板的，所以我们需要把它编译成浏览器认识的原生的 HTML</p> <ol><li>提取出模板中的原生 HTML 和非原生 HTML，比如绑定的属性、事件、指令等等</li> <li>经过一些处理生成 render 函数</li> <li>render 函数再将模板内容生成对应的 vnode</li> <li>再经过 patch 过程( Diff )得到要渲染到视图中的 vnode</li> <li>最后根据 vnode 创建真实的 DOM 节点，也就是原生 HTML 插入到视图中，完成渲染</li></ol> <h2 id="九、vue中style标签中的scoped是如何工作的"><a href="#九、vue中style标签中的scoped是如何工作的" class="header-anchor">#</a> 九、Vue中style标签中的scoped是如何工作的</h2> <ol><li>每个组件都会拥有一个<code>[data-v-hash:8]</code>插入HTML标签，子组件标签上也具体父组件<code>[data-v-hash:8]</code>;</li> <li>如果style标签加了<code>scoped属性</code>，里面的选择器都会变成<code>(Attribute Selector) [data-v-hash:8]</code>;</li> <li>如果子组件选择器跟父组件选择器完全一样，那么就会出现子组件样式被父组件覆盖，因为<code>子组件会优先于父组件mounted</code>，有兴趣可以测试一下哦。</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
    <span class="token string-property property">&quot;debug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node --inspect-brk ./node_modules/webpack/bin/webpack.js&quot;</span>  
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="十、vue3怎么设置全局变量"><a href="#十、vue3怎么设置全局变量" class="header-anchor">#</a> 十、Vue3怎么设置全局变量</h2> <p><strong>方法一</strong>    config.globalProperties</p> <p><code>vue2.x</code>挂载全局是使用 <code>Vue.prototype.$xxxx=xxx</code> 的形式来挂载，然后通过 <code>this.$xxx</code>来获取挂载到全局的变量或者方法。</p> <p>这在 <code>Vue 3</code> 中，就等同于 <code>config.globalProperties</code>。这些 <code>property</code> 将被复制到应用中作为实例化组件的一部分</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 之前 (Vue 2.x)</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$http</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 之后 (Vue 3.x)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span><span class="token function-variable function">$http</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>方法二    Provide/Inject</strong></p> <p>vue3新的 <code>provide/inject</code> 功能可以穿透多层组件，实现数据从父组件传递到子组件。</p> <p>可以将全局变量放在根组件的 <code>provide</code> 中，这样所有的组件都能使用到这个变量。</p> <p>如果需要变量是响应式的，就需要在 <code>provide</code> 的时候使用 <code>ref</code> 或者 <code>reactive</code> 包装变量。</p> <h2 id="十一、刷新浏览器后-vuex的数据是否存在-如何解决"><a href="#十一、刷新浏览器后-vuex的数据是否存在-如何解决" class="header-anchor">#</a> 十一、刷新浏览器后，Vuex的数据是否存在？如何解决？</h2> <p>在vue项目中用vuex来做全局的状态管理， 发现当刷新网页后，保存在vuex实例store里的数据会丢失。</p> <p>原因：因为 <code>store</code> 里的数据是保存在运行内存中的，当页面刷新时，页面会重新加载vue实例，store里面的数据就会被重新赋值初始化。</p> <p>我们有两种方法解决该问题：</p> <ol><li>使用 <code>vuex-along</code></li> <li>使用 <code>localStorage</code> 或者 <code>sessionStroage</code></li></ol> <h3 id="vuex-along的使用方法"><a href="#vuex-along的使用方法" class="header-anchor">#</a> vuex-along的使用方法</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//先执行npm install vuex-along --save</span>

<span class="token comment">//配置 `vuex-along`: 在 `store/index.js` 中最后添加以下代码:</span>

<span class="token keyword">import</span> VueXAlong <span class="token keyword">from</span> <span class="token string">'vuex-along'</span> <span class="token comment">//导入插件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">//modules: {</span>
        <span class="token comment">//controler  //模块化vuex</span>
    <span class="token comment">//},</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">VueXAlong</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'store'</span><span class="token punctuation">,</span>     <span class="token comment">//存放在localStroage或者sessionStroage 中的名字</span>
        <span class="token literal-property property">local</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>      <span class="token comment">//是否存放在local中  false 不存放 如果存放按照下面session的配置</span>
        <span class="token literal-property property">session</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">list</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">isFilter</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">//如果值不为false 那么可以传递对象 其中 当isFilter设置为true时， list 数组中的值就会被过滤调,这些值不会存放在seesion或者local中</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="使用-localstorage-或者-sessionstroage"><a href="#使用-localstorage-或者-sessionstroage" class="header-anchor">#</a> 使用 <code>localStorage</code> 或者 <code>sessionStroage</code></h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//在页面加载时读取sessionStorage里的状态信息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;store&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">replaceState</span><span class="token punctuation">(</span>
        Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>
          <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">,</span>
          <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;store&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//在页面刷新时将vuex里的信息保存到sessionStorage里</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;beforeunload&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;store&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="十二、vite"><a href="#十二、vite" class="header-anchor">#</a> 十二、Vite</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//创建vite项目</span>
$ npm create vite@latest

<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 启动开发服务器，别名：`vite dev`，`vite serve`</span>
    <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite build&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 为生产环境构建产物</span>
    <span class="token string-property property">&quot;preview&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite preview&quot;</span> <span class="token comment">// 本地预览生产构建产物</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十三、vue中-route和-router有什么区别"><a href="#十三、vue中-route和-router有什么区别" class="header-anchor">#</a> 十三、Vue中$route和$router有什么区别</h2> <h3 id="this-router"><a href="#this-router" class="header-anchor">#</a> this.$router</h3> <p>是 router 实例,通过 <code>this.$router</code> 访问路由器,相当于获取了整个路由文件，在<code>$router.option.routes</code>中，或查看到当前项目的整个路由结构 具有实例方法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 导航守卫</span>
router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 必须调用 `next` */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">beforeResolve</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 必须调用 `next` */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 动态导航到新路由</span>
router<span class="token punctuation">.</span>push
router<span class="token punctuation">.</span>replace
router<span class="token punctuation">.</span>go
router<span class="token punctuation">.</span>back
router<span class="token punctuation">.</span>forward
</code></pre></div><h3 id="this-route"><a href="#this-route" class="header-anchor">#</a> this.$route</h3> <p>当前激活的路由信息对象。这个属性是只读的，里面的属性是 immutable (不可变) 的，不过可以 watch (监测变化) 它。</p> <p>通过 <code>this.$route</code> 访问的是当前路由，获取和当前路由有关的信息</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token literal-property property">fullPath</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>  <span class="token comment">// 当前路由完整路径，包含查询参数和 hash 的完整路径</span>
<span class="token literal-property property">hash</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token comment">// 当前路由的 hash 值 (锚点)</span>
<span class="token literal-property property">matched</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 包含当前路由的所有嵌套路径片段的路由记录 </span>
<span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 路由文件中自赋值的meta信息</span>
<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token comment">// 路由名称</span>
<span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment">// 一个 key/value 对象，包含了动态片段和全匹配片段就是一个空对象。</span>
<span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>  <span class="token comment">// 字符串，对应当前路由的路径</span>
<span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment">// 一个 key/value 对象，表示 URL 查询参数。跟随在路径后用'?'带的参数</span>
</code></pre></div><h2 id="十四、vue3响应式的使用"><a href="#十四、vue3响应式的使用" class="header-anchor">#</a> 十四、Vue3响应式的使用</h2> <p>本文带大家从头开始学习如何实现简单版 Vue 3 响应式，实现了 Vue3 Reactivity 中的核心方法（ <code>effect</code> / <code>track</code> / <code>trigger</code> / <code>computed</code> /<code>ref</code> 等方法</p> <p>通常我们有三种方法读取一个对象的属性：</p> <ol><li>使用 <code>.</code> 操作符：<code>leo.name</code> ；</li> <li>使用 <code>[]</code> ： <code>leo['name']</code> ；</li> <li>使用 <code>Reflect</code> API： <code>Reflect.get(leo, 'name')</code> 。</li></ol> <p><strong>Proxy</strong> 对象用于创建一个对象的代理，从而实现基本操作的拦截和自定义（如属性查找、赋值、枚举、函数调用等）。语法如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
</code></pre></div><ul><li>target : 要使用 Proxy 包装的目标对象（可以是任何类型的对象，包括原生数组，函数，甚至另一个代理）。</li> <li>handler : 一个通常以函数作为属性的对象，各属性中的函数分别定义了在执行各种操作时代理 <code>p</code> 的行为。</li></ul> <h3 id="引入-ref-方法"><a href="#引入-ref-方法" class="header-anchor">#</a> 引入 ref 方法</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 0</span>

count<span class="token punctuation">.</span>value<span class="token operator">++</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><p><strong>使用 <code>rective</code> 函数</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">ref</span> <span class="token operator">=</span> <span class="token parameter">intialValue</span> <span class="token operator">=&gt;</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> intialValue<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>使用对象的属性访问器（计算属性）</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">ref</span> <span class="token operator">=</span> <span class="token parameter">raw</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> r <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">track</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> raw<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token keyword">set</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        raw <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
      <span class="token function">trigger</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用方式"><a href="#使用方式" class="header-anchor">#</a> 使用方式</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> product <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token literal-property property">quantity</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> salePrice <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    salePrice<span class="token punctuation">.</span>value <span class="token operator">=</span> product<span class="token punctuation">.</span>price <span class="token operator">*</span> <span class="token number">0.9</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    total <span class="token operator">=</span> salePrice<span class="token punctuation">.</span>value <span class="token operator">*</span> product<span class="token punctuation">.</span>quantity
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> salePrice<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 18 9</span>
product<span class="token punctuation">.</span>quantity <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> salePrice<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 45 9</span>
product<span class="token punctuation">.</span>price <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> salePrice<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 90 18</span>
</code></pre></div><h3 id="实现简易-computed-方法"><a href="#实现简易-computed-方法" class="header-anchor">#</a> 实现简易 Computed 方法</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">computed</span> <span class="token operator">=</span> <span class="token parameter">getter</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> result<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">getter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> product <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token literal-property property">quantity</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> salePrice <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> product<span class="token punctuation">.</span>price <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> total <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> salePrice<span class="token punctuation">.</span>value <span class="token operator">*</span> product<span class="token punctuation">.</span>quantity<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>total<span class="token punctuation">.</span>value<span class="token punctuation">,</span> salePrice<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
product<span class="token punctuation">.</span>quantity <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>total<span class="token punctuation">.</span>value<span class="token punctuation">,</span> salePrice<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
product<span class="token punctuation">.</span>price <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>total<span class="token punctuation">.</span>value<span class="token punctuation">,</span> salePrice<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="十五、history和hash模式的区别"><a href="#十五、history和hash模式的区别" class="header-anchor">#</a> 十五、history和hash模式的区别</h2> <h3 id="hash-模式"><a href="#hash-模式" class="header-anchor">#</a> hash 模式</h3> <p>hash 模式是一种把前端路由的路径用井号 <code>#</code> 拼接在真实 URL 后面的模式。当井号 <code>#</code> 后面的路径发生变化时，浏览器并不会重新发起请求，而是会触发 <code>hashchange</code> 事件。hash模式兼容性比较好。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;#/a&quot;</span><span class="token operator">&gt;</span><span class="token constant">A</span>页面<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;#/b&quot;</span><span class="token operator">&gt;</span><span class="token constant">B</span>页面<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash
  <span class="token punctuation">}</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span> render<span class="token punctuation">)</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h3 id="history-模式"><a href="#history-模式" class="header-anchor">#</a> history 模式</h3> <p>history API 是 H5 提供的新特性，允许开发者直接更改前端路由，即更新浏览器 URL 地址而不重新发起请求。兼容性不如 hash，且需要服务端支持，否则一刷新页面就404了，</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;javascript:toA();&quot;</span><span class="token operator">&gt;</span><span class="token constant">A</span>页面<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;javascript:toB();&quot;</span><span class="token operator">&gt;</span><span class="token constant">B</span>页面<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">toA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'/a'</span><span class="token punctuation">)</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">toB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'/b'</span><span class="token punctuation">)</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> render<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

history<span class="token punctuation">.</span><span class="token function">replaceState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'/b'</span><span class="token punctuation">)</span> <span class="token comment">// 替换路由</span>
history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'/a'</span><span class="token punctuation">)</span> <span class="token comment">// 路由压栈</span>
history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 返回</span>
history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 前进</span>
history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 后退2次</span>
</code></pre></div><h2 id="十六、vnode有哪些属性"><a href="#十六、vnode有哪些属性" class="header-anchor">#</a> 十六、VNode有哪些属性</h2> <ol><li>__v_isVNode: true，内部属性，表示为Vnode</li> <li>__v_skip: true，内部属性，表示跳过响应式转换，Reactive转换时会根据此属性进行判断</li> <li>isCompatRoot?: <em>true</em>，用于是否做了兼容处理的判断</li> <li>type: VNodeTypes，虚拟节点的类型</li> <li>props: (VNodeProps &amp; ExtraProps) | <em>null</em>，虚拟节点的props</li> <li>key: <em>string</em> | <em>number</em> | <em>null</em>，虚拟阶段的key，可用于diff</li> <li>ref: VNodeNormalizedRef | <em>null</em>，虚拟阶段的引用</li> <li>children: VNodeNormalizedChildren，子节点</li> <li>component: ComponentInternalInstance | null，组件实例</li> <li>scopeId: <em>string</em> | <em>null</em>，仅限于SFC(单文件组件)，在设置currentRenderingInstance当前渲染实例时，一期设置</li> <li>slotScopeIds: <em>string</em>[] | <em>null</em>，仅限于单文件组件，与单文件组件的插槽有关</li> <li>transition: TransitionHooks | null，TransitionHooks</li> <li>dirs: DirectiveBinding[] | null，当前Vnode绑定的指令</li></ol> <h2 id="十七、vue2-0为什么不能检查数组的变化"><a href="#十七、vue2-0为什么不能检查数组的变化" class="header-anchor">#</a> 十七、Vue2.0为什么不能检查数组的变化</h2> <p>​		<strong>Vue检测数据的变动是通过Object.defineProperty实现的，所以无法监听数组的添加操作是可以理解的，因为是在构造函数中就已经为所有属性做了这个检测绑定操作。无法检测通过索引改变数组的操作。即vm.items[indexOfItem] = newValue？</strong></p> <p>​		Vue对数组的7个变异方法（push、pop、shift、unshift、splice、sort、reverse）实现了响应式。这里就不做测试了。</p> <p>​		对于对象而言，每一次的数据变更都会对对象的属性进行一次枚举，一般对象本身的属性数量有限，所以对于遍历枚举等方式产生的性能损耗可以忽略不计，但是对于数组而言呢？数组包含的元素量是可能达到成千上万，假设对于每一次数组元素的更新都触发了枚举/遍历，其带来的性能损耗将与获得的用户体验不成正比，故vue无法检测数组的变动。Vue3.0用proxy代替了<code>defineProperty</code>之后就解决了这个问题。</p> <h3 id="解决方案"><a href="#解决方案" class="header-anchor">#</a> 解决方案</h3> <h4 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//1.这是个深度的修改，某些情况下可能导致你不希望的结果，因此最好还是慎用</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>dataArr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originArr
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataArr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">'修改第一个元素'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataArr<span class="token punctuation">)</span>        
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>originArr<span class="token punctuation">)</span>  <span class="token comment">//同样的 源数组也会被修改 在某些情况下会导致你不希望的结果 </span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$set</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> index<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token comment">//2.splice</span>
splice（）
<span class="token comment">//3.利用临时变量进行中转</span>
<span class="token keyword">let</span> tempArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>targetArr<span class="token punctuation">]</span>
tempArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">}</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>targetArr <span class="token operator">=</span> tempArr
</code></pre></div><h4 id="对象"><a href="#对象" class="header-anchor">#</a> 对象</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//this.$set(obj, key ,value) - 可实现增、改</span>
<span class="token comment">//watch时添加deep：true深度监听，只能监听到属性值的变化，新增、删除属性无法监听</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">'blog'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>getCatalog<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token comment">// immediate: true // 是否第一次触发</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//watch时直接监听某个key</span>
<span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">'obj.name'</span><span class="token punctuation">(</span>curVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十八、vue页面渲染流程"><a href="#十八、vue页面渲染流程" class="header-anchor">#</a> 十八、Vue页面渲染流程</h2> <p><code>_render</code> 开始构建 <code>VNode</code>，核心方法为 <code>createElement</code>，一般会创建普通的 <code>VNode</code> ，遇到组件就创建组件类型的 <code>VNode</code>，否则就是未知标签的 <code>VNode</code>，构建完成传递给 <code>_update</code>。</p> <p><code>patch</code> 阶段根据 <code>VNode</code> 创建真实节点树，核心方法为 <code>createElm</code>，首先遇到组件类型的 <code>VNode</code>，内部会执行 <code>$mount</code>，再走一遍相同的流程。普通节点类型则创建一个真实节点，如果它有子节点开始递归调用 <code>createElm</code>，使用 <code>insert</code> 插入子节点，直到没有子节点就填充内容节点。最后递归完成后，同样也是使用 <code>insert</code> 将整个节点树插入到页面中，再将旧的根节点移除。</p> <h2 id="十九、react与vue区别"><a href="#十九、react与vue区别" class="header-anchor">#</a> 十九、React与Vue区别</h2> <p>React 是由Facebook创建的JavaScript UI框架，React推广了 Virtual DOM( 虚拟 DOM )并创造了 JSX 语法。JSX 语法的出现允许我们在 javascript 中书写 HTML 代码。</p> <p>VUE 是由尤雨溪开发的，VUE 使用了模板系统而不是JSX，因其实模板系统都是用的普通的 HTML，所以对应用的升级更方便、更容易，而不需要整体重构。</p> <p>VUE 相较于 React 更容易上手，如果是一个有一定开发经验的开发者，甚至都不需要花额外的时间去学习，直接一遍开发一遍查文挡即可。</p> <p>React 整体是函数式的思想，在 React 中是单向数据流，推崇结合 immutable 来实现数据不可变。</p> <p>而 Vue 的思想是响应式的，也就是基于是数据可变的，通过对每一个属性建立 Watcher 来监听，当属性变化的时候，响应式的更新对应的虚拟 DOM。</p> <p>如上，所以 React 的性能优化需要手动去做，而Vue的性能优化是自动的，但是Vue的响应式机制也有问题，就是当 state 特别多的时候，Watcher 会很多，会导致卡顿。</p> <h2 id="二十、computed和watch的区别"><a href="#二十、computed和watch的区别" class="header-anchor">#</a> 二十、computed和watch的区别</h2> <h3 id="computed"><a href="#computed" class="header-anchor">#</a> computed</h3> <p>​		计算属性基于 data 中声明过或者父组件传递的 props 中的数据通过计算得到的一个<strong>新值</strong>，这个新值只会根据已知值的变化而变化，简言之：这个属性依赖其他属性，由<strong>其他属性计算而来</strong>的。具有缓存的特性，只有<strong>依赖型数据</strong>发生<strong>改变</strong>，computed 才会重新计算。如果 computed 属性值是一个函数，那么默认会走 get 方法，必须要有一个返回值，函数的返回值就是属性的属性值。计算属性定义了 fullName 并返回对应的结果给这个变量，变量不可被重复定义和赋值。</p> <p><strong>计算属性的高级</strong></p> <p>在computed 中的属性都有一个 <strong>get</strong> 和一个 <strong>set</strong> 方法，当数据变化时，调用 set 方法。下面我们通过计算属性的 getter/setter 方法来实现对属性数据的显示和监视，即双向绑定。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">fullName</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//读取当前属性值的回调，根据相关的数据计算并返回当前属性的值</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 当属性值发生改变时回调，更新相关的属性数据，val就是fullName的最新属性值</span>
            <span class="token keyword">const</span> names <span class="token operator">=</span> val <span class="token operator">?</span> val<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="watch-监听属性"><a href="#watch-监听属性" class="header-anchor">#</a> <strong>watch 监听属性</strong></h3> <p>​		通过 vm 对象的 $watch() 或 watch 配置来监听 Vue 实例上的属性变化，或某些特定数据的变化，然后执行某些具体的业务逻辑操作。当属性变化时，回调函数自动调用，在函数内部进行计算。其可以监听的数据来源：data，props，computed 内的数据。</p> <div class="language- extra-class"><pre><code>	监听函数有两个参数，第一个参数是最新的值，第二个参数是输入之前的值，顺序一定是**新值，旧值**，如果只写一个参数，那就是最新属性值
</code></pre></div><p>​		当需要在数据变化时执行异步或开销较大的操作时，watch方式是最有用的。所以 watch 一定是<strong>支持异步</strong>的。</p> <p>​        deep: true    深度监听对象内部值的变化，可以在选项参数中指定，注意监听数组的变更不需要这么做。</p> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结：</h3> <h4 id="computed-2"><a href="#computed-2" class="header-anchor">#</a> <strong>computed</strong></h4> <ul><li>初始化显示或者相关的 data、props 等属性数据发生变化的时候调用；</li> <li>计算属性不在 data 中，它是基于data 或 props 中的数据通过计算得到的一个新值，这个新值根据已知值的变化而变化；</li> <li>在 computed 属性对象中定义计算属性的方法，和取data对象里的数据属性一样，以属性访问的形式调用；</li> <li>如果 computed 属性值是函数，那么默认会走 get 方法，必须要有一个返回值，函数的返回值就是属性的属性值；</li> <li>computed 属性值默认会<strong>缓存</strong>计算结果，在重复的调用中，只要依赖数据不变，直接取缓存中的计算结果，只有<strong>依赖型数据</strong>发生<strong>改变</strong>，computed 才会重新计算；</li> <li>在computed中的，属性都有一个 get 和一个 set 方法，当数据变化时，调用 set 方法。</li></ul> <h4 id="watch"><a href="#watch" class="header-anchor">#</a> <strong>watch</strong></h4> <ul><li>主要用来监听某些特定数据的变化，从而进行某些具体的业务逻辑操作，可以看作是 computed 和 methods 的结合体；</li> <li>可以监听的数据来源：data，props，computed内的数据；</li> <li>watch<strong>支持异步</strong>；</li> <li><strong>不支持缓存</strong>，监听的数据改变，直接会触发相应的操作；</li> <li>监听函数有两个参数，第一个参数是最新的值，第二个参数是输入之前的值，顺序一定是新值，旧值。</li></ul> <h2 id="二十一、vue-loader"><a href="#二十一、vue-loader" class="header-anchor">#</a> 二十一、Vue-Loader</h2> <div class="language- extra-class"><pre class="language-text"><code>使用 vue-loader 的之前， 我们需要安装一些必要的 loader。。

必需的 loader 包括：vue-loader、vue-style-loader、vue-template-compiler、css-loader。 可能需要的 loader 包含：sass-loader、less-loader、url-loader 等。
</code></pre></div><p>一个包含 <strong>vue-loader</strong> 的简单 <strong>webpack配置</strong> 如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> VueLoaderPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-loader'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> isProduction <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span>
<span class="token keyword">const</span> extractLoader <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">loader</span><span class="token operator">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">'../'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hmr</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> cssExtractplugin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'[name].css'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">'[id].css'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ignoreOrder</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'vue-loader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token literal-property property">oneOf</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                <span class="token literal-property property">resourceQuery</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\?vue</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>isProduction <span class="token operator">?</span> extractLoader  <span class="token operator">:</span> <span class="token string">'vue-style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>isProduction <span class="token operator">?</span> extractLoader  <span class="token operator">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        isProduction <span class="token operator">?</span> cssExtractplugin <span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">]</span>

<span class="token punctuation">}</span>

</code></pre></div><h3 id="vue-loader-工作原理"><a href="#vue-loader-工作原理" class="header-anchor">#</a> vue-loader 工作原理</h3> <p>​		通过vue-loader，webpack可以将.vue文件转化为浏览器可识别的javascript。</p> <p><strong>vue-loader</strong> 的工作流程， 简单来说，分为以下几个步骤:</p> <ol><li>将一个 <strong>.vue 文件</strong> 切割成 <strong>template</strong>、<strong>script</strong>、<strong>styles</strong> 三个部分。</li> <li><strong>template 部分</strong> 通过 <strong>compile</strong> 生成 <strong>render</strong>、 <strong>staticRenderFns</strong>。</li> <li>获取 <strong>script 部分</strong> 返回的配置项对象 <strong>scriptExports</strong>。</li> <li><strong>styles 部分</strong>，会通过 <strong>css-loader</strong>、<strong>vue-style-loader</strong>， 添加到 <strong>head</strong> 中， 或者通过 <strong>css-loader</strong>、<strong>MiniCssExtractPlugin</strong> 提取到一个 <strong>公共的css文件</strong> 中。</li> <li>使用 <strong>vue-loader</strong> 提供的 <strong>normalizeComponent</strong> 方法， <strong>合并 scriptExports、render、staticRenderFns</strong>， 返回 <strong>构建vue组件需要的配置项对象 - options</strong>， 即 <strong>{data, props, methods, render, staticRenderFns...}</strong>。</li></ol> <p><strong>css scoped</strong> 的 <strong>工作流程</strong> 如下:</p> <ol><li>使用 <strong>vue-loader</strong> 处理 <strong>.vue</strong> 文件， 根据 <strong>.vue 文件</strong> 的 <strong>请求路径</strong> 和 <strong>文件内容</strong>， 生成 <strong>.vue 文件</strong> 的 <strong>hash</strong> 值, 如：<strong>7ba5bd90</strong>；</li> <li>如果 <strong>.vue 文件</strong> 的 <strong>某一个 style 标签</strong> 有 <strong>scoped</strong> 属性， 为 <strong>.vue 文件</strong> 生成一个 <strong>scopedId</strong>，<strong>scopedId</strong> 的格式为 <strong>data-v-hash</strong>， 如：<strong>data-v-7ba5bd90</strong>；</li> <li>使用 <strong>vue-loader</strong> 从 <strong>.vue 文件</strong> 中获取 <strong>style区域块(scoped)</strong> 的 *<em>样式内容(字符串)**；如果使用了 *<em>less</em></em> 或者 <strong>sass</strong>， 要使用 <strong>less-loader</strong> 或者 <strong>sass-loader</strong> 处理 <strong>样式内容</strong>，使 <strong>样式内容</strong> 变为 <strong>浏览器可识别的css样式</strong>； 然后使用 <strong>PostCSS</strong> 提供的 <strong>parser</strong> 处理 <strong>样式内容</strong>， 为 <strong>样式内容</strong> 中的每一个 <strong>css选择器</strong> 添加 *<em>[data-v-hash]**； 再使用 *<em>css-loader</em></em>；最后使用 <strong>style-loader</strong> 把 <strong>css 样式</strong> 添加到 <strong>head</strong> 中或者通过 <strong>miniCssExtractPlugin</strong> 将 <strong>css 样式</strong> 提取一个公共的 <strong>css</strong> 文件中。</li> <li>通过 <strong>normalizer</strong> 方法返回 <strong>完整的组件配置项 options</strong>， <strong>options</strong> 中有属性 <strong>_scopeId</strong>, 如 <strong>_scopedId: data-v-7ba5bd90</strong>;</li> <li>使用 <strong>组件配置项 options</strong> 构建组件实例， 给 <strong>组件</strong> 中每一个 <strong>dom元素</strong> 添加属性: <strong>data-v-hash</strong>。</li></ol> <h3 id="css-modules"><a href="#css-modules" class="header-anchor">#</a> CSS Modules</h3> <p>我们也可以在 .vue 文件 的 style 标签 上添加 module 属性， 使得 style 标签 中的 样式 变为 组件私有，具体使用方法详见 - 官网。</p> <p><strong>css scoped</strong> 的实质是利用 <strong>css属性选择器</strong> 使得 <strong>样式</strong> 称为 <strong>局部样式</strong>，而 <strong>css modules</strong> 的实质是让 <strong>样式的类名、id名唯一</strong> 使得 <strong>样式</strong> 称为 <strong>局部样式</strong>。</p> <p>使用 <strong>vue-loader</strong> 处理 <strong>.vue</strong> 文件， 将 <strong>.vue 文件内容</strong> 转化为 <strong>js 代码</strong>。 如果 <strong>.vue 文件</strong> 中的 <strong>style 标签</strong> 中有 <strong>module</strong> 属性， 向 <strong>js 代码</strong> 中注入一个 <strong>injectStyle</strong> 方法</p> <h2 id="二十二、自定义指令"><a href="#二十二、自定义指令" class="header-anchor">#</a> 二十二、自定义指令</h2> <h3 id="输入框防抖"><a href="#输入框防抖" class="header-anchor">#</a> 输入框防抖</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 1.设置v-debounce自定义指令</span>
Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'debounce'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">bind</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> debounceTime <span class="token operator">=</span> binding<span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment">// 防抖时间</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>debounceTime<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 用户若不设置防抖时间，则默认2s</span>
      debounceTime <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> cbFun<span class="token punctuation">;</span>
    el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cbFun<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 第一次执行</span>
        cbFun <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          cbFun <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> debounceTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        event <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span><span class="token function">stopImmediatePropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 2.为button标签设置v-debounce自定义指令</span>
<span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;sayHello&quot;</span> v<span class="token operator">-</span>debounce<span class="token operator">&gt;</span>提交<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
</code></pre></div><h3 id="图片懒加载"><a href="#图片懒加载" class="header-anchor">#</a> 图片懒加载</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> LazyLoad <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// install方法</span>
    <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span>options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token comment">// 代替图片的loading图</span>
        <span class="token keyword">let</span> defaultSrc <span class="token operator">=</span> options<span class="token punctuation">.</span>default<span class="token punctuation">;</span>
        Vue<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'lazy'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
            <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>binding</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                LazyLoad<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span>binding<span class="token punctuation">.</span>value<span class="token punctuation">,</span>defaultSrc<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">inserted</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">// 兼容处理</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">'IntersectionObserver'</span> <span class="token keyword">in</span> window<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    LazyLoad<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                    LazyLoad<span class="token punctuation">.</span><span class="token function">listenerScroll</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 初始化</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>val<span class="token punctuation">,</span>def</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// data-src 储存真实src</span>
        el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置src为loading图</span>
        el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>def<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 利用IntersectionObserver监听el</span>
    <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> io <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token parameter">entries</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> realSrc <span class="token operator">=</span> el<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isIntersecting<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>realSrc<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    el<span class="token punctuation">.</span>src <span class="token operator">=</span> realSrc<span class="token punctuation">;</span>
                    el<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        io<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 监听scroll事件</span>
    <span class="token function">listenerScroll</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> handler <span class="token operator">=</span> LazyLoad<span class="token punctuation">.</span><span class="token function">throttle</span><span class="token punctuation">(</span>LazyLoad<span class="token punctuation">.</span>load<span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LazyLoad<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">handler</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 加载真实图片</span>
    <span class="token function">load</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> windowHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight
        <span class="token keyword">let</span> elTop <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">;</span>
        <span class="token keyword">let</span> elBtm <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bottom<span class="token punctuation">;</span>
        <span class="token keyword">let</span> realSrc <span class="token operator">=</span> el<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>elTop <span class="token operator">-</span> windowHeight<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>elBtm <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>realSrc<span class="token punctuation">)</span><span class="token punctuation">{</span>
                el<span class="token punctuation">.</span>src <span class="token operator">=</span> realSrc<span class="token punctuation">;</span>
                el<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 节流</span>
    <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span>delay</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> timer<span class="token punctuation">;</span> 
        <span class="token keyword">let</span> prevTime<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">let</span> currTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>prevTime<span class="token punctuation">)</span> prevTime <span class="token operator">=</span> currTime<span class="token punctuation">;</span>
            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>currTime <span class="token operator">-</span> prevTime <span class="token operator">&gt;</span> delay<span class="token punctuation">)</span><span class="token punctuation">{</span>
                prevTime <span class="token operator">=</span> currTime<span class="token punctuation">;</span>
                <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                prevTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> LazyLoad<span class="token punctuation">;</span>
</code></pre></div><h3 id="一键-copy的功能"><a href="#一键-copy的功能" class="header-anchor">#</a> 一键 Copy的功能</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ant-design-vue'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> vCopy <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">//</span>
  <span class="token comment">/*
    bind 钩子函数，第一次绑定时调用，可以在这里做初始化设置
    el: 作用的 dom 对象
    value: 传给指令的值，也就是我们要 copy 的值
  */</span>
  <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    el<span class="token punctuation">.</span>$value <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token comment">// 用一个全局属性来存传进来的值，因为这个值在别的钩子函数里还会用到</span>
    el<span class="token punctuation">.</span><span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>el<span class="token punctuation">.</span>$value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 值为空的时候，给出提示，我这里的提示是用的 ant-design-vue 的提示，你们随意</span>
        Message<span class="token punctuation">.</span><span class="token function">warning</span><span class="token punctuation">(</span><span class="token string">'无复制内容'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 动态创建 textarea 标签</span>
      <span class="token keyword">const</span> textarea <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'textarea'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 将该 textarea 设为 readonly 防止 iOS 下自动唤起键盘，同时将 textarea 移出可视区域</span>
      textarea<span class="token punctuation">.</span>readOnly <span class="token operator">=</span> <span class="token string">'readonly'</span><span class="token punctuation">;</span>
      textarea<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">'absolute'</span><span class="token punctuation">;</span>
      textarea<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'-9999px'</span><span class="token punctuation">;</span>
      <span class="token comment">// 将要 copy 的值赋给 textarea 标签的 value 属性</span>
      textarea<span class="token punctuation">.</span>value <span class="token operator">=</span> el<span class="token punctuation">.</span>$value<span class="token punctuation">;</span>
      <span class="token comment">// 将 textarea 插入到 body 中</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>textarea<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 选中值并复制</span>
      textarea<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// textarea.setSelectionRange(0, textarea.value.length);</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">'Copy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'复制成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>textarea<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 绑定点击事件，就是所谓的一键 copy 啦</span>
    el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> el<span class="token punctuation">.</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 当传进来的值更新的时候触发</span>
  <span class="token function">componentUpdated</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    el<span class="token punctuation">.</span>$value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 指令与元素解绑的时候，移除事件绑定</span>
  <span class="token function">unbind</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> el<span class="token punctuation">.</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> vCopy<span class="token punctuation">;</span>
</code></pre></div><p>关于自定义组件还有很多应用场景，如：拖拽指令、页面水印、权限校验等等应用场景</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/studyblog.github.io/Components/vue/Axios.html" class="prev">
        Axios
      </a></span> <span class="next"><a href="/studyblog.github.io/Components/WebPack/webpack.html">
        WebPack
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎你的关注 
    </div> <div class="operation" style="right:90px;bottom:40px;display:none;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:none;" data-v-5775ee02></i></div> <canvas id="banniang" width="240" height="352" class="live2d" style="right:-45px;bottom:-95px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div></div></div>
    <script src="/studyblog.github.io/assets/js/app.f0e12a78.js" defer></script><script src="/studyblog.github.io/assets/js/40.d9be3eca.js" defer></script><script src="/studyblog.github.io/assets/js/108.7ad6bf33.js" defer></script>
  </body>
</html>
